{% extends "/student/student_base.html" %}
{% block title %}- Payment History {% endblock %}
{% block content %}
    <style>    
        /* Content Sections */
        .content-section {
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .section-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            border: none;
            cursor: pointer;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(120, 119, 198, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        /* Filter Tabs */
        .filter-tabs {
            display: flex;
            gap: 5px;
            background: rgba(20, 20, 30, 0.5);
            border-radius: 12px;
            padding: 5px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-btn {
            padding: 10px 20px;
            border-radius: 8px;
            background: transparent;
            border: none;
            color: var(--text-light);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }

        .tab-btn.active {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
        }

        /* Payment Cards */
        .payments-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .payment-card {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 25px;
            transition: all 0.3s ease;
            position: relative;
        }

        .payment-card:hover {
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .payment-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .payment-info {
            flex: 1;
        }

        .payment-ref {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin: 0 0 5px 0;
        }

        .payment-date {
            color: var(--text-light);
            font-size: 0.9rem;
            margin: 0;
        }

        .payment-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-success {
            background: rgba(34, 197, 94, 0.2);
            color: rgb(34, 197, 94);
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .status-pending {
            background: rgba(249, 115, 22, 0.2);
            color: rgb(249, 115, 22);
            border: 1px solid rgba(249, 115, 22, 0.3);
        }

        .status-failed {
            background: rgba(239, 68, 68, 0.2);
            color: rgb(239, 68, 68);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .payment-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .detail-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .detail-label {
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text);
        }

        .detail-value.amount {
            color: var(--primary);
            font-size: 1.1rem;
        }

        .payment-method {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .payment-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Statistics Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(20, 20, 30, 0.7);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 10px 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: var(--text);
        }

        .empty-state p {
            margin-bottom: 25px;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--text-light);
        }

        /* Export Options */
        .export-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .mobile-menu-toggle {
                display: block;
            }
        }

        @media (max-width: 768px) {
            .payment-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .payment-details {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .payment-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .payment-actions .btn {
                justify-content: center;
            }
            
            .filter-tabs {
                flex-direction: column;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .search-box input {
                width: 180px;
            }
            
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }

        @media (max-width: 480px) {
            .payment-card {
                padding: 20px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .section-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .export-options {
                flex-direction: column;
                width: 100%;
            }
        }
    </style>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <button class="mobile-menu-toggle" id="mobileMenuToggle">â˜°</button>
            <div class="page-title">
                <h1>Payment History</h1>
                <p>View your complete payment records and transaction history</p>
            </div>
            <div class="header-actions">
                <div class="search-box">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Search payments...">
                </div>
                <div class="notification-btn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18 8C18 6.4087 17.3679 4.88258 16.2426 3.75736C15.1174 2.63214 13.5913 2 12 2C10.4087 2 8.88258 2.63214 7.75736 3.75736C6.63214 4.88258 6 6.4087 6 8C6 15 3 17 3 17H21C21 17 18 15 18 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M13.73 21C13.5542 21.3031 13.3019 21.5547 12.9982 21.7295C12.6946 21.9044 12.3504 21.9965 12 21.9965C11.6496 21.9965 11.3054 21.9044 11.0018 21.7295C10.6982 21.5547 10.4458 21.3031 10.27 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div class="notification-badge">{{ notifications_count }}</div>
                </div>
            </div>
        </div>

        <!-- Statistics Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-value">Ksh {{ stats.total_paid or 0 }}</div>
                <div class="stat-label">Total Paid</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.successful_payments or 0 }}</div>
                <div class="stat-label">Successful Payments</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.pending_payments or 0 }}</div>
                <div class="stat-label">Pending Payments</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ stats.total_transactions or 0 }}</div>
                <div class="stat-label">Total Transactions</div>
            </div>
        </div>

        <!-- Filter Tabs -->
        <div class="filter-tabs">
            <button class="tab-btn active" onclick="filterPayments('all')">All Payments</button>
            <button class="tab-btn" onclick="filterPayments('success')">Successful</button>
            <button class="tab-btn" onclick="filterPayments('pending')">Pending</button>
            <button class="tab-btn" onclick="filterPayments('failed')">Failed</button>
        </div>

        <!-- Section Header -->
        <div class="section-header">
            <h3 class="section-title">
                Payment Records 
                <span style="color: var(--text-light); font-size: 1rem; margin-left: 10px;">
                    ({{ payments|length }} transactions)
                </span>
            </h3>
            <div class="export-options">
                <button class="btn btn-outline" onclick="exportToPDF()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Export PDF
                </button>
                <button class="btn btn-outline" onclick="exportToCSV()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Export CSV
                </button>
            </div>
        </div>

        <!-- Payments Container -->
        <div class="payments-container" id="paymentsContainer">
            {% for payment in payments %}
            <div class="payment-card" data-payment-status="{{ payment.payment_status.lower() }}">
                <div class="payment-header">
                    <div class="payment-info">
                        <h3 class="payment-ref">{{ payment.payment_reference_number }}</h3>
                        <p class="payment-date">Paid on {{ payment.payment_date.strftime('%B %d, %Y') }}</p>
                    </div>
                    <span class="payment-status status-{{ payment.payment_status.lower() }}">
                        {{ payment.payment_status }}
                    </span>
                </div>

                <div class="payment-details">
                    <div class="detail-group">
                        <span class="detail-label">Amount</span>
                        <span class="detail-value amount">Ksh {{ payment.payment_amount }}</span>
                    </div>
                    <div class="detail-group">
                        <span class="detail-label">Booking Reference</span>
                        <span class="detail-value">{{ payment.booking_reference_number }}</span>
                    </div>
                    <div class="detail-group">
                        <span class="detail-label">Room</span>
                        <span class="detail-value">{{ payment.room_number }} - {{ payment.hostel_name }}</span>
                    </div>
                    <div class="detail-group">
                        <span class="detail-label">Payment Method</span>
                        <span class="payment-method">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                {% if payment.payment_method == 'Mpesa' %}
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" fill="#00A650"/>
                                <path d="M12 6C8.69 6 6 8.69 6 12C6 15.31 8.69 18 12 18C15.31 18 18 15.31 18 12C18 8.69 15.31 6 12 6Z" fill="white"/>
                                <path d="M12 8C9.79 8 8 9.79 8 12C8 14.21 9.79 16 12 16C14.21 16 16 14.21 16 12C16 9.79 14.21 8 12 8Z" fill="#00A650"/>
                                {% elif payment.payment_method == 'Bank Transfer' %}
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" fill="#3B82F6"/>
                                <path d="M12 6L8 12H16L12 6Z" fill="white"/>
                                {% else %}
                                <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" fill="#6B7280"/>
                                <rect x="8" y="8" width="8" height="8" rx="1" fill="white"/>
                                {% endif %}
                            </svg>
                            {{ payment.payment_method }}
                        </span>
                    </div>
                </div>

                <div class="payment-actions">
                    <button class="btn btn-outline" onclick="viewPaymentDetails('{{ payment.payment_id }}')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 12C1 12 5 4 12 4C19 4 23 12 23 12C23 12 19 20 12 20C5 20 1 12 1 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        View Details
                    </button>
                    <button class="btn btn-outline" onclick="downloadReceipt('{{ payment.payment_id }}')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Download Receipt
                    </button>
                    {% if payment.payment_status == 'Pending' %}
                    <button class="btn btn-success" onclick="retryPayment('{{ payment.payment_id }}')">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M23 4V10H17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M1 20V14H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M3.51 9C4.01717 7.56678 4.87913 6.2854 6.01547 5.27542C7.1518 4.26543 8.52547 3.55976 10.0083 3.22426C11.4911 2.88875 13.0348 2.93434 14.4952 3.35677C15.9556 3.77921 17.2853 4.56471 18.36 5.64L23 10M1 14L5.64 18.36C6.71475 19.4353 8.04437 20.2208 9.50481 20.6432C10.9652 21.0657 12.5089 21.1113 13.9917 20.7757C15.4745 20.4402 16.8482 19.7346 17.9845 18.7246C19.1209 17.7146 19.9828 16.4332 20.49 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Retry Payment
                    </button>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Empty State -->
        {% if not payments %}
        <div class="empty-state">
            <div class="empty-state-icon">
                <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M19.4 15C19.2669 15.3044 19.1343 15.6087 19.0001 15.913C18.509 16.8954 17.8381 17.7487 17.0715 18.5153C15.6094 19.9774 13.695 20.761 11.7885 20.925C10.6824 21.0212 9.56619 20.8859 8.51563 20.5156C7.46506 20.1453 6.50492 19.5487 5.69697 18.7578C4.10469 17.1655 3.23828 15.0656 3.075 12.7885C2.91172 10.5114 3.52266 8.39063 4.875 6.75C5.46094 6.03281 6.15469 5.41406 6.9375 4.92188" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 4.5V12L15.375 13.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <h3>No Payment History</h3>
            <p>You haven't made any payments yet. Start by making your first payment for a booking.</p>
            <div class="section-actions" style="justify-content: center;">
                <a href="/student/bookings" class="btn btn-outline">View Bookings</a>
                <a href="/student/rooms" class="btn btn-primary">Book a Room</a>
            </div>
        </div>
        {% endif %}
    </div>

    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuToggle').addEventListener('click', function() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        });

        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const mobileToggle = document.getElementById('mobileMenuToggle');
            
            if (window.innerWidth <= 1024 && 
                !sidebar.contains(event.target) && 
                !mobileToggle.contains(event.target) &&
                sidebar.classList.contains('active')) {
                sidebar.classList.remove('active');
            }
        });

        // Filter payments by status
        function filterPayments(status) {
            // Update active tab
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Filter payments
            const payments = document.querySelectorAll('.payment-card');
            let visibleCount = 0;
            
            payments.forEach(payment => {
                const paymentStatus = payment.getAttribute('data-payment-status');
                
                if (status === 'all' || paymentStatus === status) {
                    payment.style.display = 'block';
                    visibleCount++;
                } else {
                    payment.style.display = 'none';
                }
            });
            
            // Update results count
            const resultsCount = document.querySelector('.section-title span');
            if (resultsCount) {
                resultsCount.textContent = `(${visibleCount} transactions)`;
            }
            
            // Show empty state if no payments match
            const emptyState = document.querySelector('.empty-state');
            if (visibleCount === 0 && !emptyState) {
                showEmptyState(status);
            } else if (emptyState) {
                emptyState.style.display = 'none';
            }
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const payments = document.querySelectorAll('.payment-card');
            let visibleCount = 0;
            
            payments.forEach(payment => {
                const paymentText = payment.textContent.toLowerCase();
                
                if (paymentText.includes(searchTerm)) {
                    payment.style.display = 'block';
                    visibleCount++;
                } else {
                    payment.style.display = 'none';
                }
            });
            
            // Update results count
            const resultsCount = document.querySelector('.section-title span');
            if (resultsCount) {
                resultsCount.textContent = `(${visibleCount} transactions)`;
            }
        });

        // View payment details
        function viewPaymentDetails(paymentId) {
            // Show payment details modal or redirect to details page
            window.location.href = `/student/payments/${paymentId}`;
        }

        // Download receipt
        function downloadReceipt(paymentId) {
            // Generate and download receipt
            window.open(`/student/payments/${paymentId}/receipt`, '_blank');
        }

        // Retry payment
        function retryPayment(paymentId) {
            if (confirm('Do you want to retry this payment?')) {
                // Redirect to payment page with payment ID
                window.location.href = `/student/payments?retry=${paymentId}`;
            }
        }

        // Export to PDF
        function exportToPDF() {
            // Generate PDF export
            window.open('/student/payments/export/pdf', '_blank');
        }

        // Export to CSV
        function exportToCSV() {
            // Generate CSV export
            window.open('/student/payments/export/csv', '_blank');
        }

        // Show empty state for filtered results
        function showEmptyState(filter) {
            const paymentsContainer = document.getElementById('paymentsContainer');
            const emptyState = document.createElement('div');
            emptyState.className = 'empty-state';
            
            let message = '';
            switch(filter) {
                case 'success':
                    message = 'No successful payments found';
                    break;
                case 'pending':
                    message = 'No pending payments found';
                    break;
                case 'failed':
                    message = 'No failed payments found';
                    break;
                default:
                    message = 'No payments found';
            }
            
            emptyState.innerHTML = `
                <div class="empty-state-icon">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19.4 15C19.2669 15.3044 19.1343 15.6087 19.0001 15.913C18.509 16.8954 17.8381 17.7487 17.0715 18.5153C15.6094 19.9774 13.695 20.761 11.7885 20.925C10.6824 21.0212 9.56619 20.8859 8.51563 20.5156C7.46506 20.1453 6.50492 19.5487 5.69697 18.7578C4.10469 17.1655 3.23828 15.0656 3.075 12.7885C2.91172 10.5114 3.52266 8.39063 4.875 6.75C5.46094 6.03281 6.15469 5.41406 6.9375 4.92188" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 4.5V12L15.375 13.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3>${message}</h3>
                <p>Try changing your filter or search criteria.</p>
            `;
            
            paymentsContainer.appendChild(emptyState);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Initialization code to be added here
        });
    </script>
{% endblock %}